#!/bin/bash
XML_FILE=$1
XML_DIR="/home/troy/beerliberation/xml/beer"
HTML_DIR="/home/troy/beerliberation/app/html/beer"

WWWDOCROOT=/var/www/beer 
WWWRELPATH=/html/beer/

# Clean up the data (remove extraneous spaces, etc.)

# Do verification on the data

MY_DIR=`dirname $0`;

# Find a unique ID
ID=`xmlstarlet sel -t -v "/post/doc/new_beer/name" $XML_FILE | sed -e 's/ /-/g' -e 's/[^a-zA-Z0-9-]//g'`

xmlstarlet tr $MY_DIR/xsl/new_beer.xsl -s ID=$ID $XML_FILE > $XML_DIR/$ID.xml

# Generate the HTML file
WWWDOCROOT=$WWWDOCROOT WWWRELPATH=$WWWRELPATH make -C $HTML_DIR $ID.html

# Check the doc into SVN
